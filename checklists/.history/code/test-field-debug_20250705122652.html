<!DOCTYPE html>
<html>
<head>
    <title>Field Dialog Debug</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/menu.css">
</head>
<body>
    <div style="padding: 20px;">
        <h1>Field Dialog Debug</h1>
        
        <div style="margin-bottom: 20px;">
            <button id="test-new-field" class="primary-btn">Open New Field Dialog</button>
            <button id="test-show-source" class="secondary-btn">Force Show Source/Options</button>
        </div>

        <div id="test-results" style="margin-top: 20px;"></div>
    </div>

    <script type="module">
        import { showNewFieldDialog } from './js/menu-fields-actions.js';
        import { loadFieldDefinitions } from './js/data-fields.js';
        import { sharedState } from './js/constants.js';

        // Mock minimal shared state for testing
        sharedState.checklistData = { items: [] };
        sharedState.currentUser = { accessLevel: 10 };

        // Mock notification function
        window.showNotification = (type, message) => {
            const results = document.getElementById('test-results');
            const div = document.createElement('div');
            div.style.cssText = `
                padding: 10px; 
                margin: 10px 0; 
                border-radius: 4px; 
                background: ${type === 'error' ? '#fee' : type === 'success' ? '#efe' : '#eef'}; 
                color: ${type === 'error' ? '#c33' : type === 'success' ? '#363' : '#333'};
                border: 1px solid ${type === 'error' ? '#faa' : type === 'success' ? '#afa' : '#aaf'};
            `;
            div.textContent = `[${type.toUpperCase()}] ${message}`;
            results.appendChild(div);
            console.log(`[${type.toUpperCase()}] ${message}`);
        };

        document.addEventListener('DOMContentLoaded', async () => {
            await loadFieldDefinitions();
            
            document.getElementById('test-new-field').addEventListener('click', () => {
                showNewFieldDialog();
            });

            document.getElementById('test-show-source').addEventListener('click', () => {
                // Force show the source/options fields for debugging
                const sourceGroup = document.getElementById('source-group');
                const optionsGroup = document.getElementById('options-group');
                
                console.log('Found elements:', {
                    sourceGroup: !!sourceGroup,
                    optionsGroup: !!optionsGroup
                });
                
                if (sourceGroup && optionsGroup) {
                    sourceGroup.style.display = 'block';
                    optionsGroup.style.display = 'block';
                    console.log('Forced to show source and options groups');
                } else {
                    console.log('Could not find source/options groups');
                }
            });
        });
    </script>
</body>
</html>
